(this["webpackJsonpchat-application"]=this["webpackJsonpchat-application"]||[]).push([[0],{58:function(e,t,n){},59:function(e,t,n){},90:function(e,t,n){},96:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var c=n(0),s=n(48),a=n.n(s),o=(n(58),n(59),n(52)),i=n(2),l=n(32),r=n(7),u=n(49),j=(n(90),n(53)),d=n(1);function m(){var e=Object(c.useState)(null),t=Object(r.a)(e,2),n=t[0],s=t[1],a=Object(c.useState)(""),o=Object(r.a)(a,2),m=o[0],b=o[1],h=Object(c.useState)(!1),O=Object(r.a)(h,2),g=O[0],f=O[1],v=Object(c.useState)([]),x=Object(r.a)(v,2),_=x[0],p=x[1],N=Object(c.useState)(""),y=Object(r.a)(N,2),w=y[0],S=y[1],C=Object(c.useState)(!1),E=Object(r.a)(C,2),L=E[0],B=E[1],T=Object(c.useState)((function(){return window.innerWidth<=670})),k=Object(r.a)(T,2),D=k[0],W=k[1],q=Object(c.useState)(),H=Object(r.a)(q,2),A=H[0],P=H[1],z=Object(i.g)(),I=z.username,J=z.room,U=Object(i.f)(),F=function(){window.innerWidth<=670&&!D?W(!0):window.innerWidth>670&&D&&(W(!1),B(!1))};Object(c.useEffect)((function(){return window.addEventListener("resize",F),function(){window.removeEventListener("resize",F)}}),[F]),Object(c.useEffect)((function(){s(Object(u.io)("http://".concat(window.location.hostname,":5000")))}),[]),Object(c.useEffect)((function(){null===n||void 0===n||n.on("message",(function(e){console.log(e)})),null===n||void 0===n||n.on("roomData",(function(e){var t=e.room,n=e.users;P(n),S(t)})),null===n||void 0===n||n.emit("join",{username:I,room:J},(function(e){e&&(console.log(e),U.push("/"))}))}),[n]),Object(c.useEffect)((function(){null===n||void 0===n||n.on("sendLocationUrl",(function(e,t,n){var c=t.split(":"),s=c[2].split(" ");t="".concat(c[0],":").concat(c[1]," ").concat(s[1]),p([].concat(Object(l.a)(_),[{url:e,msgTime:t,username:n}])),M()})),null===n||void 0===n||n.on("messageArray",(function(e,t,n){var c=t.split(":"),s=c[2].split(" ");t="".concat(c[0],":").concat(c[1]," ").concat(s[1]),p([].concat(Object(l.a)(_),[{msg:e,msgTime:t,username:n}])),M()})),console.log(_)}),[n,_,p]);var M=function(){var e=document.querySelector(".chat__messages"),t=e.lastElementChild.offsetHeight+10,n=e.offsetHeight;e.scrollHeight-t<=e.scrollTop+n&&(e.scrollTop=e.scrollHeight)};return Object(d.jsxs)("div",{className:"chatPage",children:[D?Object(d.jsx)("div",{style:{padding:"10px"},children:Object(d.jsx)(j.a,{onClick:function(){B(!L)},className:"toggleIcon"})}):null,Object(d.jsxs)("div",{className:"chat__extDiv",children:[!D||L?Object(d.jsxs)("div",{className:"chat__sideBar",children:[Object(d.jsx)("div",{className:"chat__sideBar__heading",children:Object(d.jsx)("p",{children:w})}),Object(d.jsx)("div",{className:"chat__sideBar__users",children:null===A||void 0===A?void 0:A.map((function(e){var t=e.username;return e.username.length>=15&&(t=e.username.substring(0,15),t+="..."),Object(d.jsx)("div",{className:"chat__sideBar__user",children:Object(d.jsx)("p",{className:"chat__user",children:t})})}))})]}):null,L?null:Object(d.jsxs)("div",{className:"chat__msgPart",children:[Object(d.jsx)("div",{className:"chat__messages",children:null===_||void 0===_?void 0:_.map((function(e){var t=e.username;return e.username.length>=15&&(t=e.username.substring(0,15),t+="..."),Object(d.jsxs)("div",{className:e.username!=I?"message__box":"message__box message__box__right",children:[t,(null===e||void 0===e?void 0:e.msg)?Object(d.jsx)("p",{className:"time__rightAlinged",style:{fontWeight:"800"},children:e.msg}):Object(d.jsx)("a",{href:null===e||void 0===e?void 0:e.url,target:"_blank",children:"The current Location"}),Object(d.jsx)("p",{className:"time__rightAlinged",style:{fontWeight:"bold",opacity:"0.7"},children:e.msgTime})]})}))}),Object(d.jsxs)("div",{className:"chat__msg__bottom",children:[Object(d.jsx)("div",{className:"chat__inputForm",children:Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),f(!0),n.emit("sendMessage",{message:m,username:I},(function(e){f(!1),console.log("message has been ".concat(e," successfully"))})),b("")},children:[Object(d.jsx)("input",{type:"text",placeholder:"your message",value:m,onChange:function(e){return b(e.target.value)},required:!0}),Object(d.jsx)("button",{type:"submit",disabled:g,children:g?"sending":"send"})]})}),Object(d.jsx)("div",{className:"chat__locationButton",children:Object(d.jsx)("button",{onClick:function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){n.emit("geoLocation",{Long:e.coords.longitude,Latit:e.coords.latitude})})):console.log("can not access location")},children:"getLocation"})})]})]})]})]})}var b=n(24),h=n(31);n(96);function O(){var e=Object(c.useState)({}),t=Object(r.a)(e,2),n=t[0],s=t[1],a=Object(i.f)(),o=function(e){s(Object(h.a)(Object(h.a)({},n),{},Object(b.a)({},e.target.name,e.target.value)))};return Object(d.jsx)("div",{className:"form__extDiv",children:Object(d.jsx)("div",{className:"form__container",children:Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),a.push("/chat/".concat(n.username,"/").concat(n.room))},children:[Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("legend",{children:Object(d.jsx)("label",{children:"Usename"})}),Object(d.jsx)("input",{type:"text",name:"username",placeholder:"your name",value:null===n||void 0===n?void 0:n.username,autoComplete:"off",required:!0,onChange:o})]}),Object(d.jsxs)("fieldset",{children:[Object(d.jsx)("legend",{children:Object(d.jsx)("label",{children:"Room"})}),Object(d.jsx)("input",{type:"text",name:"room",placeholder:"enter room",value:null===n||void 0===n?void 0:n.room,required:!0,autoComplete:"off",onChange:o})]}),Object(d.jsx)("button",{type:"submit",children:"join"})]})})})}function g(){return Object(d.jsx)(o.a,{children:Object(d.jsxs)(i.c,{children:[Object(d.jsx)(i.a,{exact:!0,path:"/",children:Object(d.jsx)(O,{})}),Object(d.jsx)(i.a,{exact:!0,path:"/chat/:username/:room",children:Object(d.jsx)(m,{})})]})})}a.a.render(Object(d.jsx)(g,{}),document.getElementById("root"))}},[[97,1,2]]]);
//# sourceMappingURL=main.c42e4cc1.chunk.js.map